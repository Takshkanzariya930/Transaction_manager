{% extends "base.html" %} {% block title %}View Transaction | TS Manager{%
endblock %} {% block content %}
<div class="mb-4">
	<h2 class="mb-3">View Transactions</h2>
	<form method="POST" class="mb-4">
		{{ form.hidden_tag() }}
		<div class="mb-3">
			{{ form.member.label(class="form-label") }} {{
			form.member(class="form-control") }} {% for error in
			form.member.errors %}
			<div class="text-danger">{{ error }}</div>
			{% endfor %}
		</div>
		{{ form.submit(class="btn btn-primary") }}
	</form>
	{% if request.method == 'POST' %}
	<div class="row mb-4">
		<div class="col-md-4">
			<div class="card text-bg-success mb-3">
				<div class="card-body">
					<h5 class="card-title">Total Lend</h5>
					<p class="card-text fs-4">{{ lend }}</p>
				</div>
			</div>
		</div>
		<div class="col-md-4">
			<div class="card text-bg-danger mb-3">
				<div class="card-body">
					<h5 class="card-title">Total Borrowed</h5>
					<p class="card-text fs-4">{{ borrowed }}</p>
				</div>
			</div>
		</div>
		<div class="col-md-4">
			<div class="card text-bg-primary mb-3">
				<div class="card-body">
					<h5 class="card-title">Total (Lend + Borrowed)</h5>
					<p class="card-text fs-4">
							
						{% if not lend%}
							{%set lend = 0%}
						{% endif %}

						{% if not borrowed%}
							{%set borrowed = 0%}
						{% endif %}
						
						{{ lend + borrowed }}
					</p>
				</div>
			</div>
		</div>
	</div>
	{% endif %}
	<h3>Recent Transactions</h3>
	{% if transactions %}
	<div class="table-responsive">
		<table class="table table-striped table-bordered align-middle">
			<thead class="table-dark">
				<tr>
					<th scope="col">Transaction ID</th>
					<th scope="col">Member ID</th>
					<th scope="col">Amount</th>
					<th scope="col">Type</th>
					<th scope="col">Note</th>
					<th scope="col">Date</th>
				</tr>
			</thead>
			<tbody>
				{% for t in transactions %}
				<tr>
					<td>{{ t[0] }}</td>
					<td>{{ t[1] }}</td>
					<td>{{ t[3] }}</td>
					<td>{{ t[4] }}</td>
					<td>{{ t[5] }}</td>
					<td>{{ t[6] }}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	{% else %}
	<div class="alert alert-info">No recent transactions found.</div>
	{% endif %}
</div>
{% endblock %}
